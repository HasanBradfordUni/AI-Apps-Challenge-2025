<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Has AI - AI Calendar and Scheduling System (Calendar View)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hasAi.css') }}">
    <link rel="icon" href="https://i.postimg.cc/PqP5VwNZ/Has-AI-logo.png">
</head>
<body>
    <header>
      <h1>
        <img
          src="https://i.postimg.cc/PqP5VwNZ/Has-AI-logo.png"
          alt="The Has AI logo"
          width="50"
          height="50"
          class="logo"
        />
        Has AI
        <img
          src="https://i.postimg.cc/PqP5VwNZ/Has-AI-logo.png"
          alt="The Has AI logo"
          width="50"
          height="50"
          class="logo"
        />
      </h1>
      <hr />
      <div>
        <ul class="nav">
          <li><a href="{{ url_for('calendar.dashboard') }}" class="nav">Dashboard</a></li>
          <li><a href="{{ url_for('calendar.calendar_view') }}" class="nav" id="currentPage">Calendar</a></li>
          <li><a href="{{ url_for('calendar.voice_command') }}" class="nav">Voice Commands</a></li>
        </ul>
      </div>
    </header>

    <section class="mainBody">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message flash-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <h1 class="mainHeading">Calendar View</h1>
        
        <div class="calendar-container">
            <!-- Calendar Navigation -->
            <div class="calendar-nav">
                {% set prev_month = current_month.replace(day=1) - timedelta(days=1) %}
                {% set next_month = (current_month.replace(day=1) + timedelta(days=32)).replace(day=1) %}
                
                <button onclick="changeMonth('{{ prev_month.year }}', '{{ prev_month.month }}')" class="nav-btn">← Previous</button>
                <h2 class="subHeading">{{ current_month.strftime('%B %Y') }}</h2>
                <button onclick="changeMonth('{{ next_month.year }}', '{{ next_month.month }}')" class="nav-btn">Next →</button>
            </div>

            <!-- Calendar Grid -->
            <div class="calendar-grid">
                <!-- Day Headers - Monday to Sunday -->
                <div class="calendar-header">Mon</div>
                <div class="calendar-header">Tue</div>
                <div class="calendar-header">Wed</div>
                <div class="calendar-header">Thu</div>
                <div class="calendar-header">Fri</div>
                <div class="calendar-header">Sat</div>
                <div class="calendar-header">Sun</div>

                <!-- Calendar Days - 6 rows of 7 days = 42 days -->
                {% for day in calendar_days %}
                    <div class="calendar-day 
                                {% if not day.is_current_month %}other-month{% endif %} 
                                {% if day.is_today %}today{% endif %}" 
                         data-date="{{ day.date_string }}">
                        <div class="day-number">{{ day.day_number }}</div>
                        <div class="day-events">
                            {% for event in day.events %}
                                <div class="day-event" 
                                     data-event-id="{{ event.id }}" 
                                     onclick='editEvent("{{ event.id }}")'
                                     title="{{ event.title }} - {{ event.start_time.split(' ')[1][:5] if event.start_time else 'TBD' }}">
                                    {{ event.title[:20] }}{% if event.title|length > 20 %}...{% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- Create Event Form -->
            <div class="create-event-section">
                <h3 class="subHeading">Create New Event</h3>
                <form method="POST" action="{{ url_for('calendar.create_event') }}" class="event-form">
                    <div class="form-group">
                        <label for="title">Event Title *</label>
                        <input type="text" id="title" name="title" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" class="form-textarea" rows="3"></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="date">Date *</label>
                            <input type="date" id="date" name="date" class="form-input" required 
                                   value="{{ datetime.now().strftime('%Y-%m-%d') }}">
                        </div>

                        <div class="form-group">
                            <label for="start_time">Start Time *</label>
                            <input type="time" id="start_time" name="start_time" class="form-input" required value="09:00">
                        </div>

                        <div class="form-group">
                            <label for="duration">Duration *</label>
                            <select id="duration" name="duration" class="form-input" required>
                                <option value="15m">15 minutes</option>
                                <option value="30m">30 minutes</option>
                                <option value="45m">45 minutes</option>
                                <option value="1h" selected>1 hour</option>
                                <option value="1h30m">1.5 hours</option>
                                <option value="2h">2 hours</option>
                                <option value="3h">3 hours</option>
                                <option value="4h">4 hours</option>
                                <option value="All Day">All Day</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="platform">Select Platform</label>
                        <select id="platform" name="platform" class="form-input">
                            <option value="In Person" selected>In Person</option>
                            <option value="Microsoft Teams">Microsoft Teams</option>
                            <option value="Zoom">Zoom</option>
                            <option value="Google Meet">Google Meet</option>
                            <option value="Phone Call">Phone Call</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="location">Location/Meeting Link</label>
                        <input type="text" id="location" name="location" class="form-input"
                               placeholder="Enter location or meeting link">
                    </div>

                    <div class="form-group">
                        <label for="attendees">Attendees</label>
                        <input type="text" id="attendees" name="attendees" class="form-input"
                               placeholder="Comma-separated names or emails">
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Create Event</button>
                        <a href="{{ url_for('calendar.dashboard') }}" class="btn btn-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Edit Event Modal -->
    <div id="editEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">✏️ Edit Event</h2>
                <span class="close" onclick="closeEditModal()">&times;</span>
            </div>
            <form id="editEventForm" class="event-form">
                <input type="hidden" id="edit_event_id" name="event_id">
                
                <div class="form-group">
                    <label for="edit_title">Event Title *</label>
                    <input type="text" id="edit_title" name="title" class="form-input" required>
                </div>

                <div class="form-group">
                    <label for="edit_description">Description</label>
                    <textarea id="edit_description" name="description" class="form-textarea" rows="3"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit_date">Date *</label>
                        <input type="date" id="edit_date" name="date" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="edit_start_time">Start Time *</label>
                        <input type="time" id="edit_start_time" name="start_time" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="edit_duration">Duration *</label>
                        <select id="edit_duration" name="duration" class="form-input" required>
                            <option value="15m">15 minutes</option>
                            <option value="30m">30 minutes</option>
                            <option value="45m">45 minutes</option>
                            <option value="1h">1 hour</option>
                            <option value="1h30m">1.5 hours</option>
                            <option value="2h">2 hours</option>
                            <option value="3h">3 hours</option>
                            <option value="4h">4 hours</option>
                            <option value="All Day">All Day</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit_platform">Select Platform</label>
                    <select id="edit_platform" name="platform" class="form-input">
                        <option value="In Person">In Person</option>
                        <option value="Microsoft Teams">Microsoft Teams</option>
                        <option value="Zoom">Zoom</option>
                        <option value="Google Meet">Google Meet</option>
                        <option value="Phone Call">Phone Call</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="edit_location">Location/Meeting Link</label>
                    <input type="text" id="edit_location" name="location" class="form-input">
                </div>

                <div class="form-group">
                    <label for="edit_attendees">Attendees</label>
                    <input type="text" id="edit_attendees" name="attendees" class="form-input">
                </div>

                <div class="form-actions">
                    <button type="button" onclick="deleteEventFromModal()" class="btn btn-danger">Delete</button>
                    <button type="button" onclick="closeEditModal()" class="btn btn-secondary">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Event</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        <div class="footer">
        <div class="w-container">
          <div class="w-row">
            <div class="w-col w-col-4">
              <h3>About</h3>
              <div></div>
              <div>Has AI</div>
              <div>AI Calendar and Scheduling System</div>
              <div>Website made with Python, Flask & Html</div>
              <div>AI Projects for all</div>
              <div>
                Welcome to Has AI, a sub-brand of Akhtar Hasan Software Solutions
              </div>
            </div>
            <div class="w-col w-col-4">
              <h3>Useful Links</h3>
              <div class="footer-link-row">
                <a href="{{ url_for('calendar.dashboard') }}" class="footer-link" target="_blank">Dashboard</a>
                <a href="{{ url_for('calendar.calendar_view') }}" class="footer-link">Calendar View</a>
              </div>
              <div class="footer-link-row">
                <a href="{{ url_for('calendar.voice_command') }}" class="footer-link">Voice Commands</a>
                <a href="{{ url_for('calendar.sync_emails') }}" class="footer-link">Sync Emails</a>
              </div>
            </div>
            <div class="f-col">
              <h3>Socials</h3>
              <div>
                <img
                  src="https://assets-global.website-files.com/5739f5a49fbb0b705633b84e/5739f5a59fbb0b705633b875_social-18.svg"
                  width="20"
                  alt=""
                  class="info-icon"
                />
                <a href="https://twitter.com/PythonPrgrmrYT" class="footer-link with-icon"
                  >X (Twitter)</a
                >
              </div>
              <div>
                <img
                  src="https://cdn.prod.website-files.com/662001a30f75ce6c5c72acf8/662001a30f75ce6c5c72ad80_social-16.svg"
                  width="20"
                  alt=""
                  class="info-icon"
                />
                <a
                  href="https://www.youtube.com/channel/UCIkg7kLDRl90fHEb2tFYRwg"
                  class="footer-link with-icon"
                  >YouTube</a
                >
              </div>
              <div>
                <img
                  src="https://cdn.prod.website-files.com/662001a30f75ce6c5c72acf8/662001a30f75ce6c5c72ad88_social-33.svg"
                  width="20"
                  alt=""
                  class="info-icon"
                />
                <a
                  href="https://github.com/AkhHas2005"
                  class="footer-link with-icon"
                  >GitHub</a
                >
              </div>
              <div>
                <img
                  src="https://cdn.prod.website-files.com/662001a30f75ce6c5c72acf8/662001a30f75ce6c5c72ad6b_social-07.svg"
                  width="20"
                  alt=""
                  class="info-icon"
                />
                <a href="https://www.instagram.com/pythonprogrammeryt/" 
                class="footer-link with-icon"
                  >Instagram</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <hr />
      <h1>&copy; Akhtar Hasan (aka Python Programmer) 2025</h1>
    </footer>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>