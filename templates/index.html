{% extends "base.html" %}

{% block title %}Has AI - General AI Chatbot Hub{% endblock %}

{% block header_title %}General AI Chatbot Hub - Home{% endblock %}

{% block content %}
<!-- Pass data from Flask to JavaScript -->
<script type="text/javascript">
    // Make Flask data available to JavaScript
    window.PROMPT_MODES = JSON.parse(`{{ prompt_modes | tojson | safe | replace("'", "\\'") }}`);
    window.AVAILABLE_APPS = JSON.parse(`{{ available_apps | tojson | safe | replace("'", "\\'") }}`);
</script>

<!-- Sidebar -->
<div class="sidebar">
    <div class="mode-selector">
        <h3>üéØ Prompt Mode</h3>
        <select id="promptMode" onchange="changeMode()" class="mode-dropdown">
            {% for mode_id, mode in prompt_modes.items() %}
            <option value="{{ mode_id }}" {% if mode_id == 'general' %}selected{% endif %}>
                {{ mode.icon }} {{ mode.name }}
            </option>
            {% endfor %}
        </select>
        <p id="modeDescription" class="mode-desc">
            {{ prompt_modes.general.description }}
        </p>
    </div>

    <div class="quick-apps">
        <h3>üöÄ Quick Apps</h3>
        {% for app_id, app in available_apps.items() %}
        <div class="quick-app" onclick="suggestApp('{{ app_id }}')">
            <strong>{{ app.name }}</strong>
            <p>{{ app.description }}</p>
        </div>
        {% endfor %}
    </div>

    <div class="chat-actions">
        <button onclick="clearChat()" class="action-btn">üóëÔ∏è Clear Chat</button>
        <button onclick="exportChat()" class="action-btn">üì• Export</button>
        <button onclick="showHelp()" class="action-btn">‚ùì Help</button>
    </div>
</div>

<!-- Main Chat Area -->
<div class="main-chat">
    <div class="chat-header">
        <h2 class="mainHeading">General AI Assistant</h2>
        <div class="status-indicator">
            <span class="status-dot online"></span>
            <span class="subHeading">Online</span>
        </div>
    </div>

    <div class="chat-messages" id="chatMessages">
        <div class="message bot-message">
            <div class="message-content">
                <strong>ü§ñ AI Assistant:</strong>
                <p>Hello! I'm your AI assistant hub. I can help with general questions or direct you to specific AI apps. What would you like to do today?</p>
            </div>
            <div class="message-time" id="message-time"></div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
            <script>
                document.getElementById('message-time').textContent = moment().format('HH:mm');
            </script>
        </div>
    </div>

    <div class="chat-input-container">
        <div class="chat-input">
            <textarea id="messageInput" placeholder="Type your message here..." rows="2"></textarea>
            <button onclick="sendMessage()" id="sendButton">
                <span id="sendIcon">üì§</span>
            </button>
        </div>
        <div class="quick-suggestions">
            <button onclick="quickMessage('What can you help me with?')" class="suggestion">What can you do?</button>
            <button onclick="quickMessage('Show me available apps')" class="suggestion">Available Apps</button>
            <button onclick="quickMessage('Help me write something')" class="suggestion">Writing Help</button>
            <button onclick="quickMessage('I need coding help')" class="suggestion">Code Help</button>
        </div>
    </div>
</div>

<!-- App Suggestion Modal -->
<div id="appSuggestionModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>üéØ App Suggestion</h3>
            <button onclick="closeModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <p>I think this app might help with your request:</p>
            <div id="suggestedApp" class="suggested-app">
                <!-- App details will be populated here -->
            </div>
            <div class="modal-actions">
                <button onclick="goToApp()" class="primary-btn">Go to App</button>
                <button onclick="continueChat()" class="secondary-btn">Continue in Chat</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
{% endblock %}